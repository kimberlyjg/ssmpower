% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/displacement.R
\name{ssm_power_displacement}
\alias{ssm_power_displacement}
\title{Power for Displacement Comparison}
\usage{
ssm_power_displacement(
  delta_diff,
  amplitude,
  n,
  alpha = 0.05,
  k_delta = K_DISPLACEMENT,
  two_group = TRUE
)
}
\arguments{
\item{delta_diff}{Expected displacement difference in degrees.}

\item{amplitude}{Expected amplitude (required - precision depends on this).}

\item{n}{Sample size (per group for two-group designs).}

\item{alpha}{Significance level (default: 0.05).}

\item{k_delta}{Scaling constant in degrees (default: 31).}

\item{two_group}{Logical; TRUE for two-group comparison (default),
FALSE for single-sample test against a hypothesized value.}
}
\value{
A list containing:
\item{power}{Statistical power}
\item{delta_diff}{Expected displacement difference}
\item{amplitude}{Expected amplitude}
\item{n}{Sample size}
\item{se}{Standard error of displacement (difference)}
\item{alpha}{Significance level}
\item{k_delta}{Scaling constant used}
\item{two_group}{Whether two-group design}
\item{type}{Parameter type ("displacement")}
\item{design}{Study design ("two_sample" or "single_sample")}
}
\description{
Calculate statistical power for detecting a displacement difference
in SSM analysis.
}
\details{
The key insight is that displacement precision is INVERSELY PROPORTIONAL
to amplitude: \eqn{SE(\delta) = k_\delta / (a \times \sqrt{n})}

When amplitude approaches zero, displacement becomes undefined - there
is no peak to locate. This formula was derived using the delta method
(Oehlert, 1992) applied to the arctangent transformation of the
Fourier coefficients.
}
\examples{
# Power for detecting 30Â° difference with amplitude = 0.25, n = 100 per group
ssm_power_displacement(delta_diff = 30, amplitude = 0.25, n = 100)

# Low amplitude makes displacement imprecise
ssm_power_displacement(delta_diff = 30, amplitude = 0.10, n = 100)

}
